<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reverse Dial Method</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
      color: #333;
    }
    h1 {
      text-align: center;
    }
    label {
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 5px;
      margin: 5px 0 15px 0;
    }
    .section {
      background: white;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .results {
      background: #eef;
      padding: 10px;
      font-weight: bold;
      border-radius: 5px;
    }
    canvas {
      margin-top: 10px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Reverse Dial Method</h1>

  <div class="section">
    <h2>Dimensions - Mount both dials at 12 o'clock (same plane) and "zero"</h2>
    <label>Distance between dial contact points (A) [in]:</label>
    <input id="distA" type="number" step="0.001" />

    <label>Distance from furthest dial point to front foot (driven side)(B) [in]:</label>
    <input id="distB" type="number" step="0.001" />

    <label>Distance from furthest dial point rear foot (driven side) (C) [in]:</label>
    <input id="distC" type="number" step="0.001" />

    <label>Machine RPM:</label>
    <input id="rpm" type="number" />

    <label>Coupling Diameter (circumference/3.1416)(in):</label>
    <input id="couplingDia" type="number" step="0.01" />
  </div>

  <div class="section">
    <h2>Motor-Mounted Dial Readings (reads off driven) (D1) </h2>
    <label>12 o'clock:</label>
    <input id="m12" type="number" step="0.001" />
    <label>3 o'clock:</label>
    <input id="m3" type="number" step="0.001" />
    <label>6 o'clock:</label>
    <input id="m6" type="number" step="0.001" />
    <label>9 o'clock:</label>
    <input id="m9" type="number" step="0.001" />
  </div>

  <div class="section">
    <h2>Pump-Mounted Dial Readings (reads off driver) (D2)</h2>
    <label>12 o'clock:</label>
    <input id="p12" type="number" step="0.001" />
    <label>3 o'clock:</label>
    <input id="p3" type="number" step="0.001" />
    <label>6 o'clock:</label>
    <input id="p6" type="number" step="0.001" />
    <label>9 o'clock:</label>
    <input id="p9" type="number" step="0.001" />
  </div>

  <div class="section">
    <h2>Thermal Growth Compensation</h2>
    <label><input id="enableThermal" type="checkbox" /> Enable Thermal Growth</label>
    <br/><br/>
    <label>Motor Height from bottom of foot to Shaft Center (in):</label>
    <input id="motorHeight" type="number" step="0.01" />

    <label>Motor Temp Rise (Â°F):</label>
    <input id="motorTempRise" type="number" />

    <label>Motor Material:</label>
    <select id="motorMaterial">
      <option>Cast Steel</option>
      <option>Cast Iron</option>
      <option>Stainless Steel 316</option>
    </select>

    <label>Pump Height from bottom of foot to Shaft Center (in):</label>
    <input id="pumpHeight" type="number" step="0.01" />

    <label>Pump Temp Rise (Â°F):</label>
    <input id="pumpTempRise" type="number" />

    <label>Pump Material:</label>
    <select id="pumpMaterial">
      <option>Cast Steel</option>
      <option>Cast Iron</option>
      <option>Stainless Steel 316</option>
    </select>
  </div>

  <div class="section">
    <button onclick="calculateAlignment()">Calculate Alignment</button>
  </div>

  <div class="section results" id="results">
    <h3>Results:</h3>
    <p>Waiting for input...</p>
  </div>

  <div class="section">
    <h3>Vertical Alignment Graph</h3>
    <canvas id="vertGraph" width="400" height="150"></canvas>
    <h3>Horizontal Alignment Graph</h3>
    <canvas id="horizGraph" width="400" height="150"></canvas>
  </div>

  <script>
    function calculateAlignment() {
      const A = parseFloat(document.getElementById("distA").value);
      const B = parseFloat(document.getElementById("distB").value);
      const C = parseFloat(document.getElementById("distC").value);
      const rpm = parseFloat(document.getElementById("rpm").value);
      const couplingDia = parseFloat(document.getElementById("couplingDia").value);
      const m6 = parseFloat(document.getElementById("m6").value);
      const p6 = parseFloat(document.getElementById("p6").value);
      const m3 = parseFloat(document.getElementById("m3").value);
      const p3 = parseFloat(document.getElementById("p3").value);
      const enableThermal = document.getElementById("enableThermal").checked;
      const motorHeight = parseFloat(document.getElementById("motorHeight").value);
      const motorTemp = parseFloat(document.getElementById("motorTempRise").value);
      const pumpHeight = parseFloat(document.getElementById("pumpHeight").value);
      const pumpTemp = parseFloat(document.getElementById("pumpTempRise").value);

      // Vertical offset and angularity
      const VO = m6 - p6;
      const VA = VO / A;
      const S1 = (VA * B + VO).toFixed(4);
      const S2 = (VA * C + VO).toFixed(4);

      // Horizontal offset and angularity
      const HO = m3 - p3;
      const HA = HO / A;

      // Thermal growth
      let motorGrowth = 0, pumpGrowth = 0;
      const coeffs = {"Cast Steel": 6.6e-6, "Cast Iron": 5.5e-6, "Stainless Steel 316": 9.6e-6};
      if (enableThermal) {
        motorGrowth = coeffs[document.getElementById("motorMaterial").value] * motorTemp * motorHeight;
        pumpGrowth = coeffs[document.getElementById("pumpMaterial").value] * pumpTemp * pumpHeight;
      }

      const thermalDiff = (motorGrowth - pumpGrowth).toFixed(4);

      // Tolerances
      let vo_tol = 0.002, va_tol = 0.001, ho_tol = 0.002, ha_tol = 0.001;
      if (rpm < 1800) { vo_tol = 0.005; ho_tol = 0.005; }
      else if (rpm > 3600) { vo_tol = 0.001; ho_tol = 0.001; }

      // Final result
      const inTol = Math.abs(VO) <= vo_tol && Math.abs(VA) <= va_tol && Math.abs(HO) <= ho_tol && Math.abs(HA) <= ha_tol;
      const status = inTol ? "ðŸ˜Š (In Tolerance)" : "ðŸ˜Ÿ (Out of Tolerance)";

      document.getElementById("results").innerHTML = `
        <p>Positive values mean add shims, negative values means remove shims.</p>
        <p>Front Foot Shim (S1): ${S1} in</p>
        <p>Rear Foot Shim (S2): ${S2} in</p>
        <p>Thermal Growth Motor: ${motorGrowth.toFixed(4)} in</p>
        <p>Thermal Growth Pump: ${pumpGrowth.toFixed(4)} in</p>
        <p>Thermal Growth Diff: ${thermalDiff} in</p>
        <p>VO: ${VO.toFixed(4)} in</p>
        <p>VA: ${VA.toFixed(4)} in/in</p>
        <p>HO: ${HO.toFixed(4)} in</p>
        <p>HA: ${HA.toFixed(4)} in/in</p>
        <p>${status}</p>
        <hr />
        <p><strong>Tolerance Thresholds (based on RPM ${rpm}):</strong></p>
        <p>VO â‰¤ ${vo_tol}"</p>
        <p>VA â‰¤ ${va_tol}"/in</p>
        <p>HO â‰¤ ${ho_tol}"</p>
        <p>HA â‰¤ ${ha_tol}"/in</p>
      `;

      drawGraph("vertGraph", VO, "Vertical");
      drawGraph("horizGraph", HO, "Horizontal");
    }

    function drawGraph(id, value, label) {
      const canvas = document.getElementById(id);
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;

      ctx.beginPath();
      ctx.moveTo(centerX - 50, centerY - value * 1000);
      ctx.lineTo(centerX, centerY);
      ctx.lineTo(centerX + 50, centerY + value * 1000);
      ctx.strokeStyle = "#000";
      ctx.lineWidth = 2;
      ctx.stroke();

      ctx.font = "12px Arial";
      ctx.fillText(`${label} Alignment`, 10, 10);
    }
  </script>
</body>
</html>
