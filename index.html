<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="theme-color" content="#317EFB" />
  <link rel="manifest" href="manifest.json">
  <title>Pro Shaft Alignment Tool</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f4f6f8; }
    h2 { text-align: center; }
    input, select, button {
      font-size: 16px;
      padding: 10px;
      margin: 5px 0;
      width: 100%;
      box-sizing: border-box;
    }
    .section {
      background: #ffffff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    .result {
      font-weight: bold;
      white-space: pre-line;
      background: #e9ffe9;
      padding: 10px;
      border: 1px solid #a3d7a3;
      border-radius: 8px;
    }
    canvas {
      display: block;
      margin: 10px auto;
      background: #fff;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h2>Professional Shaft Alignment Tool</h2>

  <div class="section">
    <h3>üìè Machine Dimensions</h3>
    <input id="D" placeholder="Distance between dials (in)" type="number" step="any">
    <input id="F1" placeholder="Pump-mounted dial to pump front foot (in)" type="number" step="any">
    <input id="F2" placeholder="Motor-mounted dial to motor rear foot (in)" type="number" step="any">
    <input id="coupling" placeholder="Coupling Diameter (in)" type="number" step="any">
    <input id="rpm" placeholder="RPM" type="number" step="any">
  </div>

  <div class="section">
    <h3>üå° Thermal Growth Compensation</h3>
    <label><input type="checkbox" id="enableGrowth"> Enable Thermal Growth</label><br>
    <input id="shaftLength" placeholder="Shaft Length (in)" type="number" step="any">
    <input id="pumpTempInstall" placeholder="Pump Install Temp (¬∞C)" type="number" step="any">
    <input id="pumpTempOp" placeholder="Pump Operating Temp (¬∞C)" type="number" step="any">
    <input id="motorTempInstall" placeholder="Motor Install Temp (¬∞C)" type="number" step="any">
    <input id="motorTempOp" placeholder="Motor Operating Temp (¬∞C)" type="number" step="any">
    <select id="material">
      <option value="17">316 Stainless Steel</option>
      <option value="10.8">Cast Iron</option>
      <option value="12">Cast Steel</option>
    </select>
  </div>

  <div class="section">
    <h3>üìê Dial Readings</h3>
    <input id="A0" placeholder="Pump-mounted Dial 0¬∞ (mil)" type="number" step="any">
    <input id="A180" placeholder="Pump-mounted Dial 180¬∞ (mil)" type="number" step="any">
    <input id="B0" placeholder="Motor-mounted Dial 0¬∞ (mil)" type="number" step="any">
    <input id="B180" placeholder="Motor-mounted Dial 180¬∞ (mil)" type="number" step="any">
    <input id="sag" placeholder="Dial Sag (mil)" type="number" step="any">
  </div>

  <button onclick="calculate()">üîç Calculate Alignment</button>

  <div class="section result" id="output"></div>

  <canvas id="verticalGraph" width="300" height="100"></canvas>
  <canvas id="horizontalGraph" width="300" height="100"></canvas>

  <script>
    function calculate() {
      const A0 = parseFloat(document.getElementById('A0').value);
      const A180 = parseFloat(document.getElementById('A180').value);
      const B0 = parseFloat(document.getElementById('B0').value);
      const B180 = parseFloat(document.getElementById('B180').value);
      const D = parseFloat(document.getElementById('D').value);
      const F1 = parseFloat(document.getElementById('F1').value);
      const F2 = parseFloat(document.getElementById('F2').value);
      const sag = parseFloat(document.getElementById('sag').value);
      const shaftLength = parseFloat(document.getElementById('shaftLength').value);
      const pumpInstall = parseFloat(document.getElementById('pumpTempInstall').value);
      const pumpOp = parseFloat(document.getElementById('pumpTempOp').value);
      const motorInstall = parseFloat(document.getElementById('motorTempInstall').value);
      const motorOp = parseFloat(document.getElementById('motorTempOp').value);
      const alpha = parseFloat(document.getElementById('material').value);
      const coupling = parseFloat(document.getElementById('coupling').value);
      const rpm = parseFloat(document.getElementById('rpm').value);
      const enableGrowth = document.getElementById('enableGrowth').checked;

      if ([A0, A180, B0, B180, D, F1, F2, sag, shaftLength, pumpInstall, pumpOp, motorInstall, motorOp, alpha, coupling, rpm].some(isNaN)) {
        document.getElementById('output').innerText = "Please fill in all fields.";
        return;
      }

      const offset = ((A0 - A180) / 2) - sag;
      const angularity = ((A0 - A180) - (B0 - B180)) / D;
      const shim_front = offset + angularity * F1;
      const shim_rear = offset + angularity * (F1 + F2);

      const deltaPump = pumpOp - pumpInstall;
      const deltaMotor = motorOp - motorInstall;
      const pumpGrowth = enableGrowth ? shaftLength * 0.0254 * alpha * deltaPump / 1000000 * 39.37 * 1000 : 0;
      const motorGrowth = enableGrowth ? shaftLength * 0.0254 * alpha * deltaMotor / 1000000 * 39.37 * 1000 : 0;
      const growthDiff = pumpGrowth - motorGrowth;

      const VA = angularity.toFixed(3);
      const VO = offset.toFixed(3);
      const HA = angularity.toFixed(3);
      const HO = offset.toFixed(3);

      const tolerance = rpm < 1800 ? 2 : 1;
      const withinTolerance = Math.abs(offset) <= tolerance && Math.abs(angularity * coupling) <= tolerance;

      document.getElementById('output').innerText =
        `Vertical Offset (VO): ${VO} mils\n` +
        `Vertical Angularity (VA): ${VA} mils/in\n` +
        `Horizontal Offset (HO): ${HO} mils\n` +
        `Horizontal Angularity (HA): ${HA} mils/in\n\n` +
        `Shim Front: ${shim_front.toFixed(3)} mils\n` +
        `Shim Rear: ${shim_rear.toFixed(3)} mils\n\n` +
        `Pump Thermal Growth: ${pumpGrowth.toFixed(2)} mils\n` +
        `Motor Thermal Growth: ${motorGrowth.toFixed(2)} mils\n` +
        `Thermal Growth Difference: ${growthDiff.toFixed(2)} mils\n\n` +
        `ANSI Tolerance Limit: ¬±${tolerance} mils\n` +
        (withinTolerance ? "‚úÖ Within Tolerance" : "‚ùå Out of Tolerance");

      const ctxV = document.getElementById('verticalGraph').getContext('2d');
      const ctxH = document.getElementById('horizontalGraph').getContext('2d');
      ctxV.clearRect(0, 0, 300, 100);
      ctxH.clearRect(0, 0, 300, 100);
      ctxV.beginPath();
      ctxV.moveTo(0, 50 - offset); ctxV.lineTo(300, 50 + offset); ctxV.stroke();
      ctxH.beginPath();
      ctxH.moveTo(0, 50 - offset); ctxH.lineTo(300, 50 + offset); ctxH.stroke();
    }
  </script>
</body>
</html>
