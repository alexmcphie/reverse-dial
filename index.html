<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AlignPro Elite - Reverse Indicator Method</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
      color: #333;
    }
    h1, h2, h3 {
      text-align: center;
    }
    label {
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 5px;
      margin: 5px 0 15px 0;
    }
    .section {
      background: white;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .results {
      background: #eef;
      padding: 10px;
      font-weight: bold;
      border-radius: 5px;
    }
    canvas {
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h1>AlignPro Elite - Reverse Indicator Method</h1>

  <div class="section">
    <h2>Geometry & Readings</h2>
    <label>Distance between contact points (A) [in]:</label>
    <input id="distA" type="number" step="0.001">

    <label>Distance to front foot (B) [in]:</label>
    <input id="distB" type="number" step="0.001">

    <label>Distance to rear foot (C) [in]:</label>
    <input id="distC" type="number" step="0.001">

    <label>Machine RPM:</label>
    <input id="rpm" type="number">
  </div>

  <div class="section">
    <h2>Motor-Mounted Dial Readings</h2>
    <label>12 o'clock:</label><input id="mm12" type="number" step="0.001">
    <label>3 o'clock:</label><input id="mm3" type="number" step="0.001">
    <label>6 o'clock:</label><input id="mm6" type="number" step="0.001">
    <label>9 o'clock:</label><input id="mm9" type="number" step="0.001">
  </div>

  <div class="section">
    <h2>Pump-Mounted Dial Readings</h2>
    <label>12 o'clock:</label><input id="pm12" type="number" step="0.001">
    <label>3 o'clock:</label><input id="pm3" type="number" step="0.001">
    <label>6 o'clock:</label><input id="pm6" type="number" step="0.001">
    <label>9 o'clock:</label><input id="pm9" type="number" step="0.001">
  </div>

  <div class="section">
    <h2>Thermal Growth Compensation</h2>
    <label><input id="enableThermal" type="checkbox"> Enable Thermal Growth</label><br>

    <label>Motor Height to Shaft Center (in):</label>
    <input id="motorHeight" type="number" step="0.001">

    <label>Motor Temp Rise (Â°F):</label>
    <input id="motorTempRise" type="number">

    <label>Motor Material:</label>
    <select id="motorMaterial">
      <option>Cast Steel</option>
      <option>Cast Iron</option>
      <option>Stainless Steel 316</option>
    </select>

    <label>Pump Height to Shaft Center (in):</label>
    <input id="pumpHeight" type="number" step="0.001">

    <label>Pump Temp Rise (Â°F):</label>
    <input id="pumpTempRise" type="number">

    <label>Pump Material:</label>
    <select id="pumpMaterial">
      <option>Cast Steel</option>
      <option>Cast Iron</option>
      <option>Stainless Steel 316</option>
    </select>
  </div>

  <div class="section">
    <button onclick="calculateAlignment()">Calculate Alignment</button>
  </div>

  <div class="section results" id="results">
    <h3>Results</h3>
    <p>Awaiting input...</p>
  </div>

  <canvas id="alignmentGraph" width="500" height="250"></canvas>

  <script>
    const thermalExpansionCoefficients = {
      "Cast Steel": 6.5e-6,
      "Cast Iron": 5.5e-6,
      "Stainless Steel 316": 9.6e-6
    };

    function calculateAlignment() {
      const A = parseFloat(document.getElementById("distA").value);
      const B = parseFloat(document.getElementById("distB").value);
      const C = parseFloat(document.getElementById("distC").value);
      const rpm = parseFloat(document.getElementById("rpm").value);

      const mm6 = parseFloat(document.getElementById("mm6").value);
      const pm6 = parseFloat(document.getElementById("pm6").value);

      const enableThermal = document.getElementById("enableThermal").checked;
      const mHeight = parseFloat(document.getElementById("motorHeight").value);
      const mRise = parseFloat(document.getElementById("motorTempRise").value);
      const mMat = document.getElementById("motorMaterial").value;
      const pHeight = parseFloat(document.getElementById("pumpHeight").value);
      const pRise = parseFloat(document.getElementById("pumpTempRise").value);
      const pMat = document.getElementById("pumpMaterial").value;

      const delta = mm6 - pm6;
      const VA = delta / A;
      const S1 = VA * B;
      const S2 = VA * C;
      const VO = S1;

      const HA = (parseFloat(document.getElementById("mm3").value) - parseFloat(document.getElementById("mm9").value)) / A;
      const HO = (parseFloat(document.getElementById("mm3").value) + parseFloat(document.getElementById("mm9").value)) / 2;

      let tMotor = 0, tPump = 0, tDiff = 0;
      if (enableThermal) {
        tMotor = thermalExpansionCoefficients[mMat] * mRise * mHeight;
        tPump = thermalExpansionCoefficients[pMat] * pRise * pHeight;
        tDiff = tPump - tMotor;
      }

      const voTol = rpm >= 3600 ? 0.001 : rpm >= 1800 ? 0.002 : 0.003;
      const vaTol = 0.001;
      const hoTol = voTol;
      const haTol = 0.001;

      const inTolerance = Math.abs(VO) <= voTol && Math.abs(VA) <= vaTol && Math.abs(HO) <= hoTol && Math.abs(HA) <= haTol;

      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = `
        <p>Front Foot Shim (S1): ${(S1 - tDiff).toFixed(4)} in</p>
        <p>Rear Foot Shim (S2): ${(S2 - tDiff).toFixed(4)} in</p>
        <p>Thermal Growth Motor: ${tMotor.toFixed(5)} in</p>
        <p>Thermal Growth Pump: ${tPump.toFixed(5)} in</p>
        <p>Thermal Growth Diff: ${tDiff.toFixed(5)} in</p>
        <p>VO: ${VO.toFixed(4)} in</p>
        <p>VA: ${VA.toFixed(4)} in/in</p>
        <p>HO: ${HO.toFixed(4)} in</p>
        <p>HA: ${HA.toFixed(4)} in/in</p>
        <p>${inTolerance ? "âœ… In Tolerance ðŸ˜Š" : "ðŸ˜Ÿ (Out of Tolerance)"}</p>
      `;

      const ctx = document.getElementById("alignmentGraph").getContext("2d");
      ctx.clearRect(0, 0, 500, 250);
      ctx.beginPath();
      ctx.moveTo(100, 125 - S1 * 100); // motor
      ctx.lineTo(400, 125 - S2 * 100); // pump
      ctx.strokeStyle = "blue";
      ctx.lineWidth = 3;
      ctx.stroke();

      ctx.beginPath();
      ctx.moveTo(100, 125);
      ctx.lineTo(100, 125 - 20);
      ctx.moveTo(400, 125);
      ctx.lineTo(400, 125 - 20);
      ctx.strokeStyle = "black";
      ctx.lineWidth = 2;
      ctx.stroke();
    }
  </script>
</body>
</html>
